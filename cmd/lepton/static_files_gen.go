// Automatically generated file. Do not edit!
// Generated with "go run package/main.go"

// +build !debug

package main

func read(name string) []byte {
	return []byte(staticFiles[name])
}

var staticFiles = map[string]string{
	"photo_ir.png": "\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00P\x00\x00\x00<\b\x00\x00\x00\x00\xd4LbP\x00\x00\v\x8bIDATX\t\x05\xc1ٮeWu\x06\xe0\xff\x1fc̵\xd6ާs\xf5\xaer\xb9\xdc@acL\xec\x90(\x12\x11\x17ɳ\xe4\x05\xf3\x06Q$n\"\xc1\x05\b$\x9aĶ0.\xcb.\x8a\xaa\xd3\xed\xbd֜\xa3\xc9\xf7\xf1?lՁQ\xa5Sx!B!IJ\x95h9\xe85\xd9\x1a\xb0\\4r\xc2\\&\xc3\xd4\xce\xef.\xbe\r\xf7(0\n\xa9)p\x0f\tCi\x88\xc3\\\x02\r\xc9]\xf4V\x9d\xa2c\x92\xbe+\x19%\xa0\xf8\"sgkQ\x93\f\x88,g\xf1昐\xa1\xb6F\x8dEK$\x92\xcc4MXot\xa6\r\xabȫI\x02V\xde\xce\xd1Ou\xa38\xa4zk~\xc4\\\x10\x02M\xc7\xec\xaf\x03\x9eJb\x90b\r\x91YV[3#wc\x1eE2f\xa0\x8d\x16%\xf0T\t\xd1\xdc\x00\f\x1b\xb24Irc+i1wYk]\x06\xe6\x90\xdaJSY\x14x\x88\xcd\x0e\xe3\x04T\xb3\xb0\x01P\x882\xe9\xa2C\xfb\x9en\xeaD%\x901\x823\x84mj\\]\x89\x1c)\x03RE\x17U\x16\xbbf\x89eYc\xe92 }\x16'\x8bCK\xb4\x1at\x8c\xf0P\x0fQ\x03S\xf65\x85\xec\xd8:\xca|\x1fk\x9a\x84#\x8dS\xc1\x1b¶\xe6j\xbd\fR\xe6S\xa4\xb2\xab\xc3\x1c\x8e&\xd8:\xb5\xd4u\x10\x88\xb2h-\x95\x93\x89\xbaHnZ q\x9c\x99\x8cr\"\xb43ħ\xdb\xcd`\x82\x84t\t\x89P\x89a\xb5IT\xa5\x18\xa3̶h\xecsQK\xb7\t\xe9\x83c\xdeZ\x1e\xad8\xa4#\xe9*@\x1dWJ\xe5\xab8\xe90\"Tz\xdaꓣ\xaa\x8eF\xa4\xebȡ2dmY\x12\xac\xeb\xf0\xe9\x18\xbeC\x19\x8a\x92\x00\tV\xeb\xda[\"\x91-\xa3ɽC\xa695\xa8\x9e\x89pf\xdb\xcc\x05\x82\x11b#e\xb3\xa9\\\" \xa3\xa7\x00\x1bX⡱\x8c\xb3\x9e\xbam\xed\xb2\x90\x06\xd7\xed0;\x8e\x8fnC\u007f\xee\x89>ī\x86\xb98\xaaE'\xd2#Q\xa2\x1b+XG\xa4\x8a\b[Z\xa2C\xa7p\x19G\x1f\xe4!S\xb2\xd2c\x04\xaaכ(\xeb9vn\xa5\xb2MB\x12U\x13\x90\x12\x84\xc1\xa1\xc3:\xc1\n\xf3\x86H]\x15S\t\xad\xa3\x93ZQ6҅ԡ\x11\x8cmk\xfay\tՠ\xdb>\xac\x85\x15\x02\xe1\xda\al\xa0\x84\xe1\x8a\xd12JRd)-WQ\xeaT:Q\x90\x12\xa3\x12\xccb\xcf\xca\xe1L\xe3\xb4*\x84\xb2\xef\x00ZUf\x96\x8c\xcc\f-\xaf*3\x84\xf49\xa8`\"\xa4\xd0D{\xb7N\"ꨝ\x00\xca\xe3\xda0\x95e\x98\xe8\x12\x94~\x14Q!\xb7\x80\xa6е\x041\b\xa9\x91\x15\xde6\xcdJ\x89\x96\x14D\xdd\x00\x8e\xdb]\xf8\x96\t\xabژ\xfd\x10\xa7\xe3DG\x1a֜3i\xc1\xec(d\x94n!\x94B\x94Vƶ\x18\x06\x13\xe2`\xc25\xb33\xc1\xde\xf4\xa6z\x1b\"NI\xc4\xed\xcb\xed\xfd3\xdch\x98\x9b\x16*\x03\x1b\xa6`\x9c\x96_\x92\x18rh\xae\x0e\xd7)\xb4R% \x999p\x04j\x1a\x99r\x8b\xf29\xd4זU\xd1\xe5\xadI6\x1b\xe9\x96H\x15\xe9\n\xf8*\xc4vJf\xdb,g\x97!\xa2T\xdd\xfb\x96@\x84\xb8\f#\"VtI\xe9\xc5\f\x81\xe6\xe6z\xf0\xda}\x13w\u07fc\xd1\xfb6;\x1c\x98\x1c\xc1L\x19\xbe\xb2\xf9`\xa6gi\xd6tvg\x87m\xdc^y\xa0\x92\x15DE\xa4\x13\x80H\x8c\x16s\x96\xacT\xf7\xbc\x9a\x8ei\xddbr\xebK\xd7[T\b\xd4+͛\x0f\x94\r\xd8\xfe\xdd\xfb\xbb9\xbf?\x9e=\xb8~y\xe5\x99\x02\xf8,\x11\x1aA*rB\xdb$Xޖzt\xd7N\xca6\x03\xe7͐\x8e\x92\x86\x9e\x92\x02\xf5\x92-\x9cz\xfe\xfc\xf1[\xf3iNon\xa3\x9d\xbe\xfa&:B8\x90\x8e\xf2IL6/\xba\xc0kG\xa9\x93\xe1&\xb9\x98\x8e\xaa\xe8pZְ\x91 \xcc+$k>\xff\xe4\xc9\xfe}\xbd;?}s\xf5\xc57\xf3\xfb\xed+\xa9\xd2*\x04\x10\x8bEB\x81\x01V\x82\xa2\x95\x10\xc1TVHl\x13\t\x18\"AVXD\x90\xa5?\xbc÷\x1f\xb4\x93\xe5\xec\xc1:\xd7\xdf\xea\xa9\xff\xf5\xb6T\xa4\xa7\xd5,\x9b17\xa1H\x04\x91&\xc32\xd1(\xfa\x19\xe0\x15\xd5-v\x8e@\x02HD\xb1\xeb\xd3'\x17\x8f\x9f\xdd95@\xa7\x93m\xceh\x87\x9eL@\x85\x00\x03\tj@\x18%͛TB'5x\xb4\xa43t\xa3'\xaa\x14#\x83=N\x1e\xbf\xfd\xec\xe9iSD\x01\xfb\xf7w\xed\xa5\x9c]v\u008b\xa07H\x81\xf4\"0\xb3J\xbcJ\xd54,T:\xa9CB\xa39%\xb2\x00)\xe3\xc5;?xvB\x85p\x85\xc7\x03\xc5\xd5\xcdY\x13d\x12\xea\xd3 u\f*\xab8\x87\x93\x1e5\xb9\"\f\a\x03Fb\x95.)\x91\x0e)@0?y\xf8\xcey\x80\xc1\xb5z\x11\xe79\xe2\xf6\xec\x1a%H\x04ᒀ%\xb9re\x90K,2\xd3i:qH\xf3m\x86\x06b\x95\xa4k\x01\xd2Λ\x8dd\xe8\b\x97\xdeK\xce>\x1a\x97\xbb\xcckY\xbc\xdb8\xda\xf3\xe5ճ\xf8Cش\xc6iObJ\xcf\x02,\xaa\x8b\xbb3H\x94\x8b4\xf4@e#\x9a]\x8dlg\x84\x8e\xf5r\xc8\xe9ٹ\xde\xc9U\x86\x18Eb\xfe\xc5\xfb_>\xd9\xf9z\xf7\xafW\xc1\xa5b4\uf658,\x84RlQ\x017\xa0\xc1K\xb2(۱\u007f\xf3\xb7\xd4y9\x05\xfc\xe6\xf8\xa6\xebS\xd95\x91Ackx\xd4W\xfb\xfcz\xff\xef\u007f\xfe\xc9w\xff}\x99nv\xdb\xd9^\xd7\xdc\r!Zճ\xc4'\x02\xa90\xaf\x92\x84\xff\xee\xd7لs\x9b\xc6v#\x97\x91xڲ\x8dR\xc4\xdc\xf5\xe1G_\u007f|\xc2\xf6a\xe1\xd9?\xfc\xea\x16\x91\xc5\xe8\x10K\xa9Y\x15\xa3Z%\xb7\x9e\x88\x00\x84`\xc5\xd8\x03\xe9=\xce~t?\xe30\x0e\xd9~|\xd7J9qJ\x99\xfe\xf5\xe7?{\xb1\x9d.\xbb\x87\xafN>\xbe'\\+\xaa\xebμ\x04[\xac\x83Fe!PUU\x95\f\xd0\xefն\x86N\xe7y\xb6\xb7\xa0\xe4\xc9E\xbb-\x99\x13\xbdd|\xb5\xbdws3\x9f\xec\xde=\xdd\x1e\u007f<9\xba\xe6n75)!G)P\x95U\x18\x81\x04\xa2\xb20\xbe\xcb\a9ܖy\xcdG\x9a)q\x17\x97\xdf\xf5\x1c\xa3\x12\x9e\u007f\xaa\xe5\xf3/\xb78\xe2\x03\x9f?\xbd\v\xf8\xb6\xe5:\b\xe8\xa7NdEw`T\x01\x92\xe9\xea\xbeA\x9e\u007f\x88\xddœw۬\xcb\xfd\x13\xdb?\xfa\xb8\xbd\xfe\xf5a\x94\xb9x\xf9\xcd\xf4\xe1[\u05f7w\xe6\xdd\t\xcfv\xfd/\x87((\f\xa5\x86>\xa5tPWc\xa1\xb4\xab\x03љW\xb5\xff\x99\xed\xce^_\xa2\xb5\xb7\u007f\xf0zE5d\x02\x8eDf\xfd\xcfg\xe7O\xde\xe8$|\xe0\xcb?\u007f\xfbˑ.ئ\x849=\x95\x0e(\x98\x12\xde@\xf4,\xd1\xdb+\xd8rZ'\x13CU\xbblRo\x0eH7\x88\x80x{\x1d\xfb\x93\x9c\xd5U\xf2\u07bf\xfc~\xb8\xa3\x8f\x9d\xa5\x01\x9c{T\x95\fH\x18\x13\xe5\x84N#o '\xec\xa1\"(^\xe4\xd0\xe3w\x99\x88\xcaf^\xfa\xde\xe3<\x9d\x136\x11\xab\xbc\xfb\xc9e\x8c*\xbd\x9d)\x95\xf0R\x95\f\xab\x00\b\x94\x86X\xb2\xbe\xbb\x91j\xcd\xc6:J\xc8y7\u007f\xf9\xb2\x0f\xf7\x81\f\x92\u007f\xb4\x15\xd8\xc1\xe6\xc9\xe6\xe2?\x9ek\xb9t\xa5\n4\td@PU)$\a\"\xa1\xfc\xcdo\xe8.!\x15\xd4iV\xf6\xff\xfa]h\xcd{T\x84\xf4C\xee\xedD\x9a\x89쥵\xc7\xefI\xd3e\xbf\x18\xad\vF\xaa\xa4\xae*\xc9&\x8eb\x16`ؾ\xe8'ȓ떬\x83\x8a^\u007f\u007f\x1d\xa98*$\xb5\xacam\xbb\xad\xa9O\xa2\ro[2\xce8D\x04\xa0\x84gR$%=\x06\xb2\xaa4s|q\xa5\xaa9\x99\x16g\xb3\xe5ū\x12\xb0\xa2g߮\xaf\xbf\xfc-ep\x8en\xa3M\xed\xfc\x83SU\x01w\xa2\x9fh1U*\bI ҽ\xa6\x82\xd8U\x8e;?\x9eEl\x99\x14&8\xfc\xe7\x9fQ\xc9^C\xbc`\xf2\xe5\xa3\xc7\xed|\xf4Q\x13c#\xbf\xfc[\xb0\xcdn\xfa#\xa4\x80@13%+\xb3\xaa\x8a\x10?\u058bO\x1f*M\xd1D\xb1\x1e^\xfc}\xcd\fF(\xb0\xdf\xed\xf8\xbb\x9f\xdc\xd5\x1a\xe2\x00\xb7\x1d\xbf\xfdZd\x82\xa4~j\x8cLTO\xb0\x04\x99\x9e²\xd6\x0ecy\xe7ٻ\xc8-\xbb\x88G\xf8\xf2\xf4\xd9\xf3\xf7O\xf3*U/\xe6Y\xe5\xf0\xed\a3s\xd6rќ\xa6\x177Ee\xe9G\f\xa9\xf2J\x87(\x03k(K\xb8\xdb=\xfc\xfc\x17\xff\xf6\xf8Ď\xc8>\xd2\xd2\xe3\xe0\xa7O\x1f=\xff\xe9G\x0f\xce\xf7\u0098\xfar\xf3\x87\xf5l\ae[tF\xbd\xfe\xfeȉ\xd0\x1f'\xa22\x13i\x85Lϒ2Y\x1e\u007f\xf6\x93'\xe7w\xe5\xbe\x06\x8d\xa5\x8b\x8e~\xb8\xa2٩^<x\xf2\xe1[\xb7k\x04\xb6\xdb?\xfd^\xee\xce2\xc9l\x88opX%\xa1\x1fI\xa0\x90\xc26ye\x86\x12\xaa\xfbO>{4\xc9|\xcf\xeeN6\xe9<-\xc2\xd8.\xaftLL\x91vr\xf1\xc1\x93\xd9oF\x1f\xaf\u007f\xfb\xfb\xe5\xed\xb3\xa6\xb6\\\xff__\x98\xc3-\x15\xb6\x89\xa4-e\xeeY\x14L\xbb\xcf\xdf9U\xbb\x89\x1dvia\xcd+\xb8\xac7s\xa2\xa1\x89L\x96y\xe7ٛ\xff\xfd\xe2嶍?\xc6\a\x0fLZO\xb5;\xc8>\xac IPN3\x80Ɂ\xc0\xf9O\x1fޱ\xb6\xd3CK\"\xe9\xc9\xf2\xb2\xb1j\xd2\xc6>\xd8M\xa3\xa9\x9e?\xff\xe6\x8f߮\xf9\xf5\xaf\x9e\x9f\x99da\xc1\xd9\xd3p\xfd\b\x9b\xd4$\xd3R:l\x99\x06j\xf9\xa7G\xe7\xfb\x05\x96\xeb\x05\xef\x87S!#3\xbeқ\xd8\x03K6[\x94\x1c\xda.\xee|\xf8\xe4\xc1q\xec\x1e\xdd9S\xf9\xf3\xf7\xbe\x89\x9dl\xfa|\xecPf{\x13:T\xaa\xea\xe1\xa7'v2oC\xd3.ޜ\x17\x99\xd9}\xfb\xfa\xda\x0e֊'\x9bP\x83\xe1\xc3f\xca\xee\xf4q\xce\xef\xe9=_\xff\xf4\x9as`.c\xdb(&Z\x95t\xd3\xe6ӹ\x94l\x13]j\x8b\x97q\x9f\xaa[\x1d_\\͗О\xe7i\xb0a\xa9̃\xaa\xe6\xe9\xe9\xc4\xf1\xf2/\xf7\xff\xfeݢ\xdb\x1e\xfeH\u007f(\xa8\x88@y85\xbc\xecم6G\x0e\x81\x8b}\xf5\u05cc\xcb\xef_\xbdz\xdd\xc6:\x97s\xf2#9b\x8f\xb5w\xa3c\x9aL\xa7\xe9\xf2\xc5_\xaeڤ\"a\xe6FJu\xb3\xee^\xbdPz\x12\x91~l\x19\xec\x97\x17w\xbe\xfd\xad\xb5\xbd\x1eZ\xde\x16\x10\x919\x18\x879\xaaU\xb9\n\x99\xb3\xad\x85\xe3\xcd,\xd5&\xd5\x1b}\x1e\"\x01\xe4\xd1s\xb0\x8al?<\x0fɜP\xa8\xd1\xf7:\x80\xecs;\xc4,ޅ\xc3\r\x83{\x1bc\x1d\xae-\xb7\x9c&[\x9a\x8cF/\xa1Z)S\xab\xa3*\x95 D\x97ݛ\xe34bJT\x84\xbf\xf5p\\\xf6\xc6\xebb\xc5\x06)\xcf\x11\x1d\xbbU\xdb|\x9b2\xcdc\xe8\"}ZR\xe3\xf4\nML\x13HQ\x12\x92\nK.$X\x19\xc5\"|\xdd\x1eT*֔f\xb79\xc8L\x0e\x9fò):\xadH\x1f\xbdZ-&X.qe\xb3\xad\x02\fe\x96\xb0R\xab*\xca\xf7\x9d%鉸٦l\x01\xa5\xba\xa4\x96\x0f\xf1\b\xb0\xa0\x16\x19\xdeZ\xc1\x0f\U000e41b8\xd8\xf67\x9b\x9dl\x13\x9cm\x14+\xbb\xc2\xc5ow\xeb\x02\x83H\xa9t\xc1\x80z\x01\x92\x99\x02\xe9\x0e\x19}\x00jש\xe5\xd8\xd5v\x8cS\u038b\xcc#b\u007f\xef\xff\x01*\xfas6\"\x91\xb0\xeb\x00\x00\x00\x00IEND\xaeB`\x82",
	"root.html": "<html>\n<head>\n  <title>go-lepton</title>\n  <style>\n    .errorMsg {\n      color: red;\n    }\n    .info {\n      white-space: pre-wrap;\n    }\n    .mainImg {\n      border: 1px solid #000000;\n    }\n  </style>\n  <script>\n    var palette = [\n      255, 255, 255, 253, 253, 253, 251, 251, 251, 249, 249, 249, 247, 247, 247,\n      245, 245, 245, 243, 243, 243, 241, 241, 241, 239, 239, 239, 237, 237, 237,\n      235, 235, 235, 233, 233, 233, 231, 231, 231, 229, 229, 229, 227, 227, 227,\n      225, 225, 225, 223, 223, 223, 221, 221, 221, 219, 219, 219, 217, 217, 217,\n      215, 215, 215, 213, 213, 213, 211, 211, 211, 209, 209, 209, 207, 207, 207,\n      205, 205, 205, 203, 203, 203, 201, 201, 201, 199, 199, 199, 197, 197, 197,\n      195, 195, 195, 193, 193, 193, 191, 191, 191, 189, 189, 189, 187, 187, 187,\n      185, 185, 185, 183, 183, 183, 181, 181, 181, 179, 179, 179, 177, 177, 177,\n      175, 175, 175, 173, 173, 173, 171, 171, 171, 169, 169, 169, 167, 167, 167,\n      165, 165, 165, 163, 163, 163, 161, 161, 161, 159, 159, 159, 157, 157, 157,\n      155, 155, 155, 153, 153, 153, 151, 151, 151, 149, 149, 149, 147, 147, 147,\n      145, 145, 145, 143, 143, 143, 141, 141, 141, 139, 139, 139, 137, 137, 137,\n      135, 135, 135, 133, 133, 133, 131, 131, 131, 129, 129, 129, 126, 126, 126,\n      124, 124, 124, 122, 122, 122, 120, 120, 120, 118, 118, 118, 116, 116, 116,\n      114, 114, 114, 112, 112, 112, 110, 110, 110, 108, 108, 108, 106, 106, 106,\n      104, 104, 104, 102, 102, 102, 100, 100, 100, 98, 98, 98, 96, 96, 96, 94,\n      94, 94, 92, 92, 92, 90, 90, 90, 88, 88, 88, 86, 86, 86, 84, 84, 84, 82,\n      82, 82, 80, 80, 80, 78, 78, 78, 76, 76, 76, 74, 74, 74, 72, 72, 72, 70,\n      70, 70, 68, 68, 68, 66, 66, 66, 64, 64, 64, 62, 62, 62, 60, 60, 60, 58,\n      58, 58, 56, 56, 56, 54, 54, 54, 52, 52, 52, 50, 50, 50, 48, 48, 48, 46,\n      46, 46, 44, 44, 44, 42, 42, 42, 40, 40, 40, 38, 38, 38, 36, 36, 36, 34,\n      34, 34, 32, 32, 32, 30, 30, 30, 28, 28, 28, 26, 26, 26, 24, 24, 24, 22,\n      22, 22, 20, 20, 20, 18, 18, 18, 16, 16, 16, 14, 14, 14, 12, 12, 12, 10,\n      10, 10, 8, 8, 8, 6, 6, 6, 4, 4, 4, 2, 2, 2, 0, 0, 0, 0, 0, 9, 2, 0, 16, 4,\n      0, 24, 6, 0, 31, 8, 0, 38, 10, 0, 45, 12, 0, 53, 14, 0, 60, 17, 0, 67, 19,\n      0, 74, 21, 0, 82, 23, 0, 89, 25, 0, 96, 27, 0, 103, 29, 0, 111, 31, 0,\n      118, 36, 0, 120, 41, 0, 121, 46, 0, 122, 51, 0, 123, 56, 0, 124, 61, 0,\n      125, 66, 0, 126, 71, 0, 127, 76, 1, 128, 81, 1, 129, 86, 1, 130, 91, 1,\n      131, 96, 1, 132, 101, 1, 133, 106, 1, 134, 111, 1, 135, 116, 1, 136, 121,\n      1, 136, 125, 2, 137, 130, 2, 137, 135, 3, 137, 139, 3, 138, 144, 3, 138,\n      149, 4, 138, 153, 4, 139, 158, 5, 139, 163, 5, 139, 167, 5, 140, 172, 6,\n      140, 177, 6, 140, 181, 7, 141, 186, 7, 141, 189, 10, 137, 191, 13, 132,\n      194, 16, 127, 196, 19, 121, 198, 22, 116, 200, 25, 111, 203, 28, 106, 205,\n      31, 101, 207, 34, 95, 209, 37, 90, 212, 40, 85, 214, 43, 80, 216, 46, 75,\n      218, 49, 69, 221, 52, 64, 223, 55, 59, 224, 57, 49, 225, 60, 47, 226, 64,\n      44, 227, 67, 42, 228, 71, 39, 229, 74, 37, 230, 78, 34, 231, 81, 32, 231,\n      85, 29, 232, 88, 27, 233, 92, 24, 234, 95, 22, 235, 99, 19, 236, 102, 17,\n      237, 106, 14, 238, 109, 12, 239, 112, 12, 240, 116, 12, 240, 119, 12, 241,\n      123, 12, 241, 127, 12, 242, 130, 12, 242, 134, 12, 243, 138, 12, 243, 141,\n      13, 244, 145, 13, 244, 149, 13, 245, 152, 13, 245, 156, 13, 246, 160, 13,\n      246, 163, 13, 247, 167, 13, 247, 171, 13, 248, 175, 14, 248, 178, 15, 249,\n      182, 16, 249, 185, 18, 250, 189, 19, 250, 192, 20, 251, 196, 21, 251, 199,\n      22, 252, 203, 23, 252, 206, 24, 253, 210, 25, 253, 213, 27, 254, 217, 28,\n      254, 220, 29, 255, 224, 30, 255, 227, 39, 255, 229, 53, 255, 231, 67, 255,\n      233, 81, 255, 234, 95, 255, 236, 109, 255, 238, 123, 255, 240, 137, 255,\n      242, 151, 255, 244, 165, 255, 246, 179, 255, 248, 193, 255, 249, 207, 255,\n      251, 221, 255, 253, 235, 255, 255, 24,\n    ];\n\n    var canvasSmall = document.createElement('canvas');\n    canvasSmall.width = 80;\n    canvasSmall.height = 60;\n    var contextSmall = canvasSmall.getContext(\"2d\");\n    var imgDataSmall = contextSmall.createImageData(80, 60);\n\n    //var image = document.createElement(\"img\");\n    var elemCanvas;\n    var context;\n    var elemErrorMsg;\n    var elemInfo;\n    var Avg;\n    var Max;\n    var Min;\n\n    function onload() {\n      elemCanvas = document.getElementById(\"canvas1\");\n      context = elemCanvas.getContext(\"2d\");\n      elemErrorMsg = document.getElementById(\"errorMsg\");\n      elemInfo = document.getElementById(\"info\");\n      elemAvg = document.getElementById(\"avg\");\n      elemMax = document.getElementById(\"max\");\n      elemMin = document.getElementById(\"min\");\n      newSocket();\n      drawPalette();\n    }\n\n    function drawPalette() {\n      var ca = document.getElementById(\"canvasPalette\");\n      var ctx = ca.getContext(\"2d\");\n      var useGray = document.getElementById(\"useGray\").checked;\n      for (var y = 0; y < ca.height; y++) {\n        if (useGray) {\n          ctx.fillStyle = 'rgb('+y+','+y+','+y+')';\n        } else {\n          var base = 3*y;\n          ctx.fillStyle = 'rgb('+palette[base]+','+ palette[base+1]+','+palette[base+2]+')';\n        }\n        ctx.fillRect(0, y, ca.width, 1);\n      }\n    }\n\n    function newSocket() {\n      elemErrorMsg.innerText = \"Websocket connecting\";\n      var socket = new WebSocket(websocketURL(\"/stream\"));\n\n      socket.addEventListener(\"open\", function(event) {\n        elemErrorMsg.innerText = \"\";\n      });\n\n      socket.addEventListener(\"message\", function(event) {\n        // metadata is json encoded structure.\n        var encodedMetadata = event.data.split('\\n', 1)[0];\n        var encodedImg = event.data.slice(encodedMetadata.length);\n\n        // img is base64 encoded PNG.\n        //image.src = 'data:image/png;base64,' + encodedImg;\n        //context.drawImage(image, 0, 0, 800, 600);\n\n        // img is base64 encoded uint16.\n        // Convert from base64 to raw data.\n        var rawImg = window.atob(encodedImg);\n        // Convert from raw data to uint16 manually. In theory we should use the\n        // embedded javascript thing-y but the documentation is so bad I never\n        // figured out how.\n        var uint16 = new Uint16Array(rawImg.length/2);\n        for (i = 0; i < rawImg.length; i+=2) {\n          // little endian.\n          uint16[i/2] = rawImg.charCodeAt(i+1)*256 + rawImg.charCodeAt(i);\n        }\n\n        var maxV = -1;\n        var minV = 65536;\n        var maxX = 0;\n        var maxY = 0;\n        var minX = 0;\n        var minY = 0;\n        var avgV = 0;\n        for (var i = 0; i < uint16.length; i++) {\n          var v = uint16[i];\n          var y = i/80;\n          var x = i%80;\n          if (v < minV) {\n            minV = v;\n            minX = x;\n            minY = y;\n          }\n          if (v > maxV) {\n            maxV = v;\n            maxX = x;\n            maxY = y;\n          }\n          avgV += v;\n        }\n        avgV = avgV / uint16.length;\n        var delta = maxV-minV;\n\n        // Rasterize AGC from 14bits Gray to 8bits RGBA.\n        var useGray = document.getElementById(\"useGray\").checked;\n        for (var i = 0; i < uint16.length; i++) {\n          var o = 4*i;\n          imgDataSmall.data[o+3] = 255;\n          var intensity = Math.round((uint16[i]-minV) * 255/delta);\n\n          if (useGray) {\n            // Gray.\n            imgDataSmall.data[o] = intensity;\n            imgDataSmall.data[o+1] = intensity;\n            imgDataSmall.data[o+2] = intensity;\n          } else {\n            // Palette.\n            imgDataSmall.data[o] = palette[3*intensity];\n            imgDataSmall.data[o+1] = palette[3*intensity+2];\n            imgDataSmall.data[o+2] = palette[3*intensity+2];\n          }\n        }\n        contextSmall.putImageData(imgDataSmall, 0, 0);\n\n        // Render and stretch.\n        context.save();\n        context.scale(elemCanvas.height/canvasSmall.height, elemCanvas.width/canvasSmall.width);\n        context.drawImage(canvasSmall, 0, 0);\n        context.beginPath();\n        context.strokeStyle = \"blue\";\n        context.lineWidth = 0.1;\n        context.ellipse(minX, minY, 2, 2, 0, 0, 2 * Math.PI);\n        context.stroke();\n        context.beginPath();\n        context.strokeStyle = \"red\";\n        context.lineWidth = 0.1;\n        context.ellipse(maxX, maxY, 2, 2, 0, 0, 2 * Math.PI);\n        context.stroke();\n        context.restore();\n\n        var metadata = JSON.parse(encodedMetadata);\n        elemInfo.innerText = JSON.stringify(metadata, null, 2);\n        elemAvg.innerText = toC(avgV).toString();\n        elemMax.innerText = toC(maxV).toString();\n        elemMin.innerText = toC(minV).toString();\n      });\n\n      socket.addEventListener(\"error\", function(event) {\n        elemErrorMsg.innerText = \"Websocket error\" + event;\n      });\n\n      socket.addEventListener(\"close\", function(event) {\n        elemErrorMsg.innerText = \"Websocket closed\";\n        // Retry connecting every second.\n        window.setTimeout(newSocket, 1000);\n      });\n    }\n    \n    function toC(kVal) {\n      if (kVal > 0) {\n        return kVal / 100 - 273,15\n      } else {\n        return kVal\n      }\n    }\n\n    function websocketURL(s) {\n      var l = window.location;\n      return ((l.protocol === \"https:\") ? \"wss://\" : \"ws://\") + l.hostname + \":\" + l.port + s;\n    }\n  </script>\n</head>\n<body onload=\"onload()\">\n  <div id=\"errorMsg\" class=\"errorMsg\"></div><br>\n  <canvas id=\"canvas1\" class=\"mainImg\" width=\"800\" height=\"600\"></canvas>\n  <canvas id=\"canvasPalette\" class=\"mainImg\" width=\"50\" height=\"256\"></canvas>\n  <br>\n  <label><input id=\"useGray\" type=\"checkbox\" onchange=\"drawPalette()\">Use gray palette</label>\n  Max: <div id=\"max\"></div><br>\n  Min: <div id=\"min\"></div><br>\n  Avg: <div id=\"avg\"></div><br>\n\n  Raw data:<br>\n  <div id=\"info\" class=\"info\">Infos</div>\n</body>\n</html>\n",
}
